

为什么要lock，lock了什么？

  当我们使用线程的时候，效率最高的方式当然是异步，即各个线程同时运行，其间不相互依赖和等待。
但当不同的线程都需要访问某个资源的时候，就需要同步机制了，也就是说当对同一个资源进行读写的时候，
我们要使该资源在同一时刻只能被一个线程操作，以确保每个操作都是有效即时的，也即保证其操作的原子性。
lock是C#中最常用的同步方式，格式为lock(objectA){codeB} 。


lock(objectA){codeB} 看似简单，实际上有三个意思，这对于适当地使用它至关重要：

  1. objectA被lock了吗？没有则由我来lock，否则一直等待，直至objectA被释放。
  2. lock以后在执行codeB的期间其他线程不能调用codeB，也不能使用objectA。
  3. 执行完codeB之后释放objectA，并且codeB可以被其他线程访问。
